{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Renovate configuration for Vixens GitOps - Auto-updates with approval workflow",
  "extends": ["config:base"],
  "baseBranches": ["dev"],
  "username": "renovate-bot",
  "gitAuthor": "Renovate Bot <renovate@vixens.local>",
  "onboarding": false,
  "requireConfig": "optional",
  "repositories": ["charchess/vixens"],
  "enabledManagers": ["terraform", "helm-values", "kubernetes", "regex", "dockerfile"],
  "kubernetes": {
    "fileMatch": ["(^|/)kustomization\\.yaml$", "(^|/)[^/]*\\.yaml$"]
  },
  "helm-values": {
    "fileMatch": ["(^|/)values.*\\.yaml$"]
  },
  "terraform": {
    "fileMatch": ["(^|/)\\.tf$"]
  },
  "packageRules": [
    {
      "description": "LinuxServer.io images versioning",
      "matchPackagePatterns": ["^lscr\\.io/linuxserver/"],
      "versioning": "regex:^version-v?(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)(.*)?$"
    },
    {
      "description": "Lazylibrarian hex versioning",
      "matchPackageNames": ["lscr.io/linuxserver/lazylibrarian"],
      "versioning": "regex:^version-(?<major>[a-f0-9]+)$"
    },
    {
      "description": "Music Assistant beta versioning",
      "matchPackagePatterns": ["^ghcr\\.io/music-assistant/"],
      "versioning": "docker"
    },
    {
      "description": "AdGuard Home versioning",
      "matchPackagePatterns": ["^adguard/adguardhome"],
      "versioning": "docker"
    },
    {
      "description": "BirdNET-Go nightly versioning",
      "matchPackagePatterns": ["^ghcr\\.io/tphakala/birdnet-go"],
      "versioning": "regex:^nightly-(?<major>\\d+)$"
    },
    {
      "description": "Auto-merge minor and patch updates after approval",
      "matchUpdateTypes": ["minor", "patch", "pin", "digest"],
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "labels": ["dependencies", "renovate", "automerge"]
    },
    {
      "description": "Manual review required for major updates",
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "labels": ["dependencies", "renovate", "major-update"]
    }
  ],
  "prConcurrentLimit": 3,
  "prHourlyLimit": 2,
  "branchConcurrentLimit": 5,
  "labels": ["dependencies", "renovate"],
  "assignees": ["@charchess"],
  "reviewers": ["@charchess"],
  "schedule": ["every 6 hours"],
  "timezone": "Europe/Paris",
  "semanticCommits": "enabled",
  "commitMessagePrefix": "chore(deps):",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}",
  "prTitle": "chore(deps): update {{depName}} {{#if isMajor}}(major){{else}}{{#if isMinor}}(minor){{else}}{{#if isPatch}}(patch){{/if}}{{/if}}{{/if}}",
  "prBodyTemplate": "{{{header}}}\n\n{{{table}}}\n\n{{{notes}}}\n\n{{{changelogs}}}\n\n---\n\n### üöÄ Deployment Strategy\n\n{{#if isMajor}}‚ö†Ô∏è **Major update** - Manual review required{{else}}‚úÖ **Auto-merge enabled** - Will merge automatically after approval{{/if}}\n\n- [ ] Reviewed changes\n- [ ] Ready to deploy to dev cluster\n- [ ] Notify on Discord: `@everyone New dependency update ready for approval`\n\n---\n\n{{{footer}}}"
}
