{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Renovate configuration for Vixens GitOps - Elite Automation",
  "extends": [
    "config:recommended",
    ":dependencyDashboard"
  ],
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "üì¶ Dependency Dashboard - Control Tower",
  "dependencyDashboardAutoclose": true,
  "dependencyDashboardLabels": [
    "dependencies",
    "renovate"
  ],
  "baseBranchPatterns": [
    "main"
  ],
  "rebaseWhen": "behind-base-branch",
  "gitAuthor": "Renovate Bot <renovate@vixens.local>",
  "platformAutomerge": true,
  "automergeType": "pr",
  "automergeStrategy": "squash",
  "enabledManagers": [
    "terraform",
    "helm-values",
    "kubernetes",
    "custom.regex",
    "dockerfile"
  ],
  "kubernetes": {
    "managerFilePatterns": [
      "/apps/.+\\.yaml$/",
      "/argocd/.+\\.yaml$/"
    ]
  },
  "helm-values": {
    "managerFilePatterns": [
      "/(^|/)values.*\\.yaml$/"
    ]
  },
  "terraform": {
    "managerFilePatterns": [
      "/(^|/)\\.tf$/"
    ]
  },
  "packageRules": [
    {
      "description": "Group all minor and patch updates for non-critical dependencies",
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "matchPackageNames": [
        "*",
        "!ghcr.io/home-assistant/home-assistant",
        "!grafana/promtail",
        "!grafana/loki"
      ],
      "groupName": "minor and patch updates",
      "groupSlug": "minor-patch-all"
    },
    {
      "description": "LinuxServer.io images versioning",
      "versioning": "regex:^version-v?(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)(.*)?$",
      "matchPackageNames": [
        "/^lscr\\.io/linuxserver//"
      ]
    },
    {
      "description": "Lazylibrarian hex versioning",
      "matchPackageNames": [
        "lscr.io/linuxserver/lazylibrarian"
      ],
      "versioning": "regex:^version-(?<major>[a-f0-9]+)$"
    },
    {
      "description": "Music Assistant beta versioning",
      "versioning": "docker",
      "matchPackageNames": [
        "/^ghcr\\.io/music-assistant//"
      ]
    },
    {
      "description": "AdGuard Home versioning",
      "versioning": "docker",
      "matchPackageNames": [
        "/^adguard/adguardhome/"
      ]
    },
    {
      "description": "BirdNET-Go nightly versioning",
      "versioning": "regex:^nightly-(?<major>\\d+)$",
      "matchPackageNames": [
        "/^ghcr\\.io/tphakala/birdnet-go/"
      ]
    },
    {
      "description": "Home Assistant Auto-Update",
      "matchPackageNames": [
        "ghcr.io/home-assistant/home-assistant"
      ],
      "matchUpdateTypes": [
        "minor",
        "patch",
        "pin",
        "digest"
      ],
      "automerge": true,
      "labels": [
        "dependencies",
        "renovate",
        "automerge",
        "home-assistant"
      ]
    },
    {
      "description": "Auto-merge minor and patch updates after approval",
      "matchUpdateTypes": [
        "minor",
        "patch",
        "pin",
        "digest"
      ],
      "automerge": true,
      "labels": [
        "dependencies",
        "renovate",
        "automerge"
      ]
    },
    {
      "description": "Manual review required for major updates",
      "matchUpdateTypes": [
        "major"
      ],
      "automerge": true,
      "labels": [
        "dependencies",
        "renovate",
        "major-update"
      ]
    }
  ],
  "prConcurrentLimit": 10,
  "prHourlyLimit": 0,
  "branchConcurrentLimit": 20,
  "labels": [
    "dependencies",
    "renovate"
  ],
  "assignees": [
    "@charchess"
  ],
  "reviewers": [
    "@charchess"
  ],
  "timezone": "Europe/Paris",
  "semanticCommits": "enabled",
  "commitMessagePrefix": "chore(deps):",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}",
  "prBodyTemplate": "{{{header}}}\n\n{{{table}}}\n\n{{{notes}}}\n\n{{{changelogs}}}\n\n---\n\n### üöÄ Deployment Strategy\n\n{{#if isMajor}}‚ö†Ô∏è **Major update** - Manual review required{{else}}‚úÖ **Auto-merge enabled** - Will merge automatically after approval{{/if}}\n\n- [ ] Reviewed changes\n- [ ] Ready to deploy to main branch (dev cluster)\n- [ ] Notify on Discord: `@everyone New dependency update ready for approval`\n\n---\n\n{{{footer}}}"
}
