# clusters/vixens/argocd/apps/synology-csi.yaml
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: synology-csi
  namespace: argocd
spec:
  project: default
  sources:
  - repoURL: https://github.com/zebernst/synology-csi-talos
    targetRevision: main
    ref: upstream                 # nom de référence
  - repoURL: https://github.com/charchess/vixens.git
    targetRevision: main
    path: base/synology-csi       # contient kustomization.yaml + namespace.yaml + patch
  destination:
    server: https://kubernetes.default.svc
    namespace: synology-csi
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
    - CreateNamespace=true
