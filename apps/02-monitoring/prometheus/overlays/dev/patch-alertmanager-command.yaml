apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: prometheus-alertmanager
  namespace: monitoring
spec:
  replicas: 0
  template:
    spec:
      containers:
      - args:
        - 'cp /etc/alertmanager/alertmanager.yml /tmp/alertmanager.yml &&

          sed -i "s|DISCORD_WEBHOOK_URL_PLACEHOLDER|$DISCORD_WEBHOOK_URL|g" /tmp/alertmanager.yml
          &&

          /bin/alertmanager --config.file=/tmp/alertmanager.yml --storage.path=/alertmanager

          '
        command:
        - /bin/sh
        - -c
        name: alertmanager
