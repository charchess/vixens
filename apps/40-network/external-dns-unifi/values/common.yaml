# ExternalDNS UniFi Configuration (Private/LAN)
provider: webhook
extraArgs:
  webhook-provider-url: http://localhost:8888

# Sidecar Webhook
sidecars:
  - name: unifi-webhook
    image: ghcr.io/kashalls/external-dns-unifi-webhook:v0.8.0
    ports:
      - containerPort: 8888
        name: webhook
    env:
      - name: UNIFI_HOST
        valueFrom:
          secretKeyRef:
            name: external-dns-unifi-secret
            key: UNIFI_HOST
      - name: UNIFI_USER
        valueFrom:
          secretKeyRef:
            name: external-dns-unifi-secret
            key: UNIFI_USER
      - name: UNIFI_PASS
        valueFrom:
          secretKeyRef:
            name: external-dns-unifi-secret
            key: UNIFI_PASS
      - name: LOG_LEVEL
        value: info
      - name: UNIFI_SKIP_TLS_VERIFY
        value: "true"

tolerations:
  - key: node-role.kubernetes.io/control-plane
    operator: Exists
    effect: NoSchedule

# Scope
policy: sync
sources:
  - ingress