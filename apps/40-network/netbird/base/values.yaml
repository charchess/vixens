---
# Base values for Netbird Helm Chart

# Management Service
management:
  replicaCount: 1
  env:
    - name: NETBIRD_STORE_ENGINE
      value: "postgres"
    - name: NETBIRD_STORE_ENGINE_POSTGRES_DSN
      valueFrom:
        secretKeyRef:
          name: netbird-secrets
          key: NETBIRD_STORE_ENGINE_POSTGRES_DSN
    - name: NETBIRD_AUTH_OIDC_CONFIGURATION_ENDPOINT
      value: "https://authentik.truxonline.com/application/o/netbird/.well-known/openid-configuration"
    - name: NETBIRD_AUTH_AUDIENCE
      value: "netbird"
    - name: NETBIRD_AUTH_CLIENT_ID
      value: "netbird"
    - name: NETBIRD_AUTH_CLIENT_SECRET
      valueFrom:
        secretKeyRef:
          name: netbird-secrets
          key: NETBIRD_AUTH_CLIENT_SECRET
    - name: NETBIRD_AUTH_USER_ID_CLAIM
      value: "sub"
    # IMPORTANT: Domain config must be set in overlays

# Dashboard
dashboard:
  replicaCount: 1
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      traefik.ingress.kubernetes.io/router.entrypoints: websecure
  env:
    - name: NETBIRD_AUTH_AUDIENCE
      value: "netbird"
    - name: NETBIRD_AUTH_CLIENT_ID
      value: "netbird"
    - name: NETBIRD_AUTH_AUTHORITY
      value: "https://authentik.truxonline.com/application/o/netbird/"

# Signal Service
signal:
  replicaCount: 1
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      traefik.ingress.kubernetes.io/router.entrypoints: websecure

# Relay Service
relay:
  replicaCount: 1
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      traefik.ingress.kubernetes.io/router.entrypoints: websecure