---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: synology-csi
resources:
  - ../../base
patches:
  - path: ../../../../_shared/patches/revision-history-limit-statefulset.yaml
    target:
      kind: StatefulSet
  - path: ../../../../_shared/patches/revision-history-limit-deployment.yaml
    target:
      kind: Deployment
  # Patch du storage class pour dev
  - target:
      kind: StorageClass
      name: synelia-iscsi-retain
    patch: |-
      - op: replace
        path: /parameters/igroup
        value: "vixens-dev-iscsi-group"
      - op: add
        path: /parameters/targetIps
        value: "192.168.111.70,192.168.111.71"
  - target:
      kind: StorageClass
      name: synelia-iscsi-delete
    patch: |-
      - op: add
        path: /parameters/igroup
        value: "vixens-dev-iscsi-group"
      - op: add
        path: /parameters/targetIps
        value: "192.168.111.70,192.168.111.71"
labels:
  - pairs:
      vixens.lab/environment: dev
      cache-bust: "2"
    includeTemplates: true
