apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cert-manager
resources:
  - cluster-issuer-prod.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: argocd
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - certificate.yaml
  - ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cert-manager
patches:
  - path: gandi-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: gandi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: kubernetes-dashboard
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ippool.yaml
  - l2policy.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: add\n  path: /spec/template/spec/containers/0/resources\n  value:\n    requests:\n      cpu: 100m\n      memory: 200Mi\n    limits:\n      cpu: 500m\n      memory: 500Mi\n"
    target:
      kind: Deployment
      name: metrics-server
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: auth
labels:
  - pairs:
      environment: prod
    includeSelectors: false
patches:
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-secrets-sync
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-litestream-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: server-resources.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: worker-resources.yaml
    target:
      kind: Deployment
      name: authentik-worker
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: template-app-secrets-sync
    patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: homeassistant
patches:
  - path: infisical-config-patch.yaml
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: homeassistant-litestream-secret
resources:
  - ../../base
  - ingress.yaml
  - ingressroute-udp.yaml
  - infisical-filebrowser-auth.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mosquitto
resources:
  - ../../base
  - infisical-mosquitto-auth.yaml
  - mosquitto-tcp-ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: nfs-storage
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeTemplates: true
    pairs:
      vixens.lab/environment: prod
namespace: synology-csi
patches:
  - patch: "- op: replace\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-retain
  - patch: "- op: add\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-delete
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: synology-csi
patches:
  - path: synology-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: synology-csi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
patches:
  - target:
      kind: Ingress
      name: nocodb
    patch: |-
      - op: replace
        path: /metadata/annotations/cert-manager.io~1cluster-issuer
        value: letsencrypt-prod
      - op: replace
        path: /spec/rules/0/host
        value: nocodb.truxonline.com
      - op: replace
        path: /spec/tls/0/hosts/0
        value: nocodb.truxonline.com
  - target:
      kind: Deployment
      name: nocodb
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/env/-
        value:
          name: NC_PUBLIC_URL
          value: "https://nocodb.truxonline.com"
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
patches:
  - path: patch-nextauth-url.yaml
resources:
  - ../../base
  - infisical-secret.yaml
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: tools
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: changedetection-secrets-sync
  - patch: "- op: replace\n  path: /spec/template/spec/containers/0/env/0/value\n  value: https://changedetection.truxonline.com"
    target:
      kind: Deployment
      name: changedetection
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
patches:
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: homepage-config-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: homepage
resources:
  - ../../base
  - ingress.yaml
  - ingress-redirect.yaml
  - infisical-secret.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: netbox
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-secrets-sync
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-db-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: headlamp
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netvisor-secrets-sync
patchesStrategicMerge:
  - server-url-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mail-gateway
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: networking
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: adguard-home-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: adguard-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cnpg-system
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-credentials-env.yaml
  - path: backup-patch.yaml
    target:
      group: postgresql.cnpg.io
      version: v1
      kind: Cluster
      name: postgresql-shared
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
namespace: services
patches:
  - path: patch-infisical-secrets.yaml
patchesStrategicMerge:
  - patch-resources.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: services
patchesStrategicMerge:
  - patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: vaultwarden-secrets
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: litestream-shared-secrets
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: vaultwarden
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: booklore-secrets-sync
patchesStrategicMerge:
  - mariadb-resources-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: pyload-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: qbittorrent-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: prowlarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: prowlarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: frigate-secrets-sync
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-config-sync
  - path: shm-patch-named.yaml
    target:
      kind: Deployment
      name: frigate
  - path: node-affinity-patch.yaml
    target:
      kind: Deployment
      name: frigate
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-litestream-secret
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: amule-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: radarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: radarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: whisparr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: whisparr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: mylar-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: mylar-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patchesStrategicMerge:
  - infisical-shared-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: birdnet-go
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: lidarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: lidarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: sabnzbd-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: sabnzbd-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: sonarr-secrets-sync
    patch: |-
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
  - target:
      kind: InfisicalSecret
      name: sonarr-litestream-secret
    path: litestream-secret-patch.yaml
patchesStrategicMerge:
  - deployment-patch.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - prometheus-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: patch-alertmanager-command.yaml
    target:
      kind: StatefulSet
      name: prometheus-alertmanager
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: alertmanager-secrets-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: promtail-secrets-sync
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: monitoring
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-alertmanager-config.yaml
    target:
      kind: StatefulSet
      name: alertmanager
  - path: patch-infisical-env.yaml
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: loki-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - grafana-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: kube-system
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: hubble-ui
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: argocd
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - certificate.yaml
  - ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cert-manager
patches:
  - path: gandi-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: gandi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: kubernetes-dashboard
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ippool.yaml
  - l2policy.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: add\n  path: /spec/template/spec/containers/0/resources\n  value:\n    requests:\n      cpu: 100m\n      memory: 200Mi\n    limits:\n      cpu: 500m\n      memory: 500Mi\n"
    target:
      kind: Deployment
      name: metrics-server
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: auth
labels:
  - pairs:
      environment: prod
    includeSelectors: false
patches:
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-secrets-sync
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-litestream-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: server-resources.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: worker-resources.yaml
    target:
      kind: Deployment
      name: authentik-worker
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: template-app-secrets-sync
    patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: homeassistant
patches:
  - path: infisical-config-patch.yaml
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: homeassistant-litestream-secret
resources:
  - ../../base
  - ingress.yaml
  - ingressroute-udp.yaml
  - infisical-filebrowser-auth.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mosquitto
resources:
  - ../../base
  - infisical-mosquitto-auth.yaml
  - mosquitto-tcp-ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: nfs-storage
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeTemplates: true
    pairs:
      vixens.lab/environment: prod
namespace: synology-csi
patches:
  - patch: "- op: replace\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-retain
  - patch: "- op: add\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-delete
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: synology-csi
patches:
  - path: synology-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: synology-csi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
patches:
  - target:
      kind: Ingress
      name: nocodb
    patch: |-
      - op: replace
        path: /metadata/annotations/cert-manager.io~1cluster-issuer
        value: letsencrypt-prod
      - op: replace
        path: /spec/rules/0/host
        value: nocodb.truxonline.com
      - op: replace
        path: /spec/tls/0/hosts/0
        value: nocodb.truxonline.com
  - target:
      kind: Deployment
      name: nocodb
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/env/-
        value:
          name: NC_PUBLIC_URL
          value: "https://nocodb.truxonline.com"
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
patches:
  - path: patch-nextauth-url.yaml
resources:
  - ../../base
  - infisical-secret.yaml
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: tools
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: changedetection-secrets-sync
  - patch: "- op: replace\n  path: /spec/template/spec/containers/0/env/0/value\n  value: https://changedetection.truxonline.com"
    target:
      kind: Deployment
      name: changedetection
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
patches:
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: homepage-config-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: homepage
resources:
  - ../../base
  - ingress.yaml
  - ingress-redirect.yaml
  - infisical-secret.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: netbox
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-secrets-sync
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-db-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: headlamp
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netvisor-secrets-sync
patchesStrategicMerge:
  - server-url-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mail-gateway
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: networking
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: adguard-home-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: adguard-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cnpg-system
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-credentials-env.yaml
  - path: backup-patch.yaml
    target:
      group: postgresql.cnpg.io
      version: v1
      kind: Cluster
      name: postgresql-shared
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
namespace: services
patches:
  - path: patch-infisical-secrets.yaml
patchesStrategicMerge:
  - patch-resources.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: services
patchesStrategicMerge:
  - patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: vaultwarden-secrets
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: litestream-shared-secrets
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: vaultwarden
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: booklore-secrets-sync
patchesStrategicMerge:
  - mariadb-resources-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: pyload-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: qbittorrent-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: prowlarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: prowlarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: frigate-secrets-sync
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-config-sync
  - path: shm-patch-named.yaml
    target:
      kind: Deployment
      name: frigate
  - path: node-affinity-patch.yaml
    target:
      kind: Deployment
      name: frigate
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-litestream-secret
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: amule-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: radarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: radarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: whisparr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: whisparr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: mylar-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: mylar-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patchesStrategicMerge:
  - infisical-shared-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: birdnet-go
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: lidarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: lidarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: sabnzbd-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: sabnzbd-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: sonarr-secrets-sync
    patch: |-
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
  - target:
      kind: InfisicalSecret
      name: sonarr-litestream-secret
    path: litestream-secret-patch.yaml
patchesStrategicMerge:
  - deployment-patch.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - prometheus-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: patch-alertmanager-command.yaml
    target:
      kind: StatefulSet
      name: prometheus-alertmanager
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: alertmanager-secrets-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: promtail-secrets-sync
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: monitoring
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-alertmanager-config.yaml
    target:
      kind: StatefulSet
      name: alertmanager
  - path: patch-infisical-env.yaml
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: loki-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - grafana-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: kube-system
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: hubble-ui
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: argocd
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - certificate.yaml
  - ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cert-manager
patches:
  - path: gandi-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: gandi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: kubernetes-dashboard
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ippool.yaml
  - l2policy.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: add\n  path: /spec/template/spec/containers/0/resources\n  value:\n    requests:\n      cpu: 100m\n      memory: 200Mi\n    limits:\n      cpu: 500m\n      memory: 500Mi\n"
    target:
      kind: Deployment
      name: metrics-server
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: auth
labels:
  - pairs:
      environment: prod
    includeSelectors: false
patches:
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-secrets-sync
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-litestream-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: server-resources.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: worker-resources.yaml
    target:
      kind: Deployment
      name: authentik-worker
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: template-app-secrets-sync
    patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: homeassistant
patches:
  - path: infisical-config-patch.yaml
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: homeassistant-litestream-secret
resources:
  - ../../base
  - ingress.yaml
  - ingressroute-udp.yaml
  - infisical-filebrowser-auth.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mosquitto
resources:
  - ../../base
  - infisical-mosquitto-auth.yaml
  - mosquitto-tcp-ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: nfs-storage
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeTemplates: true
    pairs:
      vixens.lab/environment: prod
namespace: synology-csi
patches:
  - patch: "- op: replace\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-retain
  - patch: "- op: add\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-delete
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: synology-csi
patches:
  - path: synology-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: synology-csi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
patches:
  - target:
      kind: Ingress
      name: nocodb
    patch: |-
      - op: replace
        path: /metadata/annotations/cert-manager.io~1cluster-issuer
        value: letsencrypt-prod
      - op: replace
        path: /spec/rules/0/host
        value: nocodb.truxonline.com
      - op: replace
        path: /spec/tls/0/hosts/0
        value: nocodb.truxonline.com
  - target:
      kind: Deployment
      name: nocodb
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/env/-
        value:
          name: NC_PUBLIC_URL
          value: "https://nocodb.truxonline.com"
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
patches:
  - path: patch-nextauth-url.yaml
resources:
  - ../../base
  - infisical-secret.yaml
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: tools
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: changedetection-secrets-sync
  - patch: "- op: replace\n  path: /spec/template/spec/containers/0/env/0/value\n  value: https://changedetection.truxonline.com"
    target:
      kind: Deployment
      name: changedetection
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
patches:
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: homepage-config-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: homepage
resources:
  - ../../base
  - ingress.yaml
  - ingress-redirect.yaml
  - infisical-secret.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: netbox
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-secrets-sync
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-db-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: headlamp
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netvisor-secrets-sync
patchesStrategicMerge:
  - server-url-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mail-gateway
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: networking
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: adguard-home-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: adguard-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cnpg-system
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-credentials-env.yaml
  - path: backup-patch.yaml
    target:
      group: postgresql.cnpg.io
      version: v1
      kind: Cluster
      name: postgresql-shared
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
namespace: services
patches:
  - path: patch-infisical-secrets.yaml
patchesStrategicMerge:
  - patch-resources.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: services
patchesStrategicMerge:
  - patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: vaultwarden-secrets
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: litestream-shared-secrets
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: vaultwarden
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: booklore-secrets-sync
patchesStrategicMerge:
  - mariadb-resources-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: pyload-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: qbittorrent-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: prowlarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: prowlarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: frigate-secrets-sync
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-config-sync
  - path: shm-patch-named.yaml
    target:
      kind: Deployment
      name: frigate
  - path: node-affinity-patch.yaml
    target:
      kind: Deployment
      name: frigate
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-litestream-secret
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: amule-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: radarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: radarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: whisparr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: whisparr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: mylar-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: mylar-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patchesStrategicMerge:
  - infisical-shared-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: birdnet-go
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: lidarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: lidarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: sabnzbd-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: sabnzbd-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: sonarr-secrets-sync
    patch: |-
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
  - target:
      kind: InfisicalSecret
      name: sonarr-litestream-secret
    path: litestream-secret-patch.yaml
patchesStrategicMerge:
  - deployment-patch.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - prometheus-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: patch-alertmanager-command.yaml
    target:
      kind: StatefulSet
      name: prometheus-alertmanager
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: alertmanager-secrets-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: promtail-secrets-sync
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: monitoring
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-alertmanager-config.yaml
    target:
      kind: StatefulSet
      name: alertmanager
  - path: patch-infisical-env.yaml
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: loki-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - grafana-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: kube-system
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: hubble-ui
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: argocd
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - certificate.yaml
  - ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cert-manager
patches:
  - path: gandi-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: gandi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: kubernetes-dashboard
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ippool.yaml
  - l2policy.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: add\n  path: /spec/template/spec/containers/0/resources\n  value:\n    requests:\n      cpu: 100m\n      memory: 200Mi\n    limits:\n      cpu: 500m\n      memory: 500Mi\n"
    target:
      kind: Deployment
      name: metrics-server
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: auth
labels:
  - pairs:
      environment: prod
    includeSelectors: false
patches:
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-secrets-sync
  - patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
    target:
      kind: InfisicalSecret
      name: authentik-litestream-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: server-resources.yaml
    target:
      kind: Deployment
      name: authentik-server
  - path: worker-resources.yaml
    target:
      kind: Deployment
      name: authentik-worker
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: template-app-secrets-sync
    patch: |
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: homeassistant
patches:
  - path: infisical-config-patch.yaml
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: homeassistant-litestream-secret
resources:
  - ../../base
  - ingress.yaml
  - ingressroute-udp.yaml
  - infisical-filebrowser-auth.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mosquitto
resources:
  - ../../base
  - infisical-mosquitto-auth.yaml
  - mosquitto-tcp-ingressroute.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: nfs-storage
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeTemplates: true
    pairs:
      vixens.lab/environment: prod
namespace: synology-csi
patches:
  - patch: "- op: replace\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-retain
  - patch: "- op: add\n  path: /parameters/igroup\n  value: \"vixens-prod-iscsi-group\"\n- op: add\n  path: /parameters/targetIps\n  value: \"192.168.111.70,192.168.111.71\""
    target:
      kind: StorageClass
      name: synelia-iscsi-delete
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: synology-csi
patches:
  - path: synology-infisical-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: synology-csi-credentials-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
patches:
  - target:
      kind: Ingress
      name: nocodb
    patch: |-
      - op: replace
        path: /metadata/annotations/cert-manager.io~1cluster-issuer
        value: letsencrypt-prod
      - op: replace
        path: /spec/rules/0/host
        value: nocodb.truxonline.com
      - op: replace
        path: /spec/tls/0/hosts/0
        value: nocodb.truxonline.com
  - target:
      kind: Deployment
      name: nocodb
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/env/-
        value:
          name: NC_PUBLIC_URL
          value: "https://nocodb.truxonline.com"
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
patches:
  - path: patch-nextauth-url.yaml
resources:
  - ../../base
  - infisical-secret.yaml
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: tools
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: changedetection-secrets-sync
  - patch: "- op: replace\n  path: /spec/template/spec/containers/0/env/0/value\n  value: https://changedetection.truxonline.com"
    target:
      kind: Deployment
      name: changedetection
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: tools
patches:
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: homepage-config-sync
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: homepage
resources:
  - ../../base
  - ingress.yaml
  - ingress-redirect.yaml
  - infisical-secret.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: netbox
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-secrets-sync
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netbox-db-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: headlamp
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: netvisor-secrets-sync
patchesStrategicMerge:
  - server-url-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mail-gateway
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: networking
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: adguard-home-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: adguard-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cnpg-system
resources:
  - ../../base
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-credentials-env.yaml
  - path: backup-patch.yaml
    target:
      group: postgresql.cnpg.io
      version: v1
      kind: Cluster
      name: postgresql-shared
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: databases
resources:
  - ../../base
patches:
  - path: patch-infisical-env.yaml
labels:
  - pairs:
      environment: prod
    includeSelectors: false
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      environment: prod
namespace: services
patches:
  - path: patch-infisical-secrets.yaml
patchesStrategicMerge:
  - patch-resources.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: services
patchesStrategicMerge:
  - patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: vaultwarden-secrets
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: litestream-shared-secrets
  - path: deployment-patch.yaml
    target:
      kind: Deployment
      name: vaultwarden
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: booklore-secrets-sync
patchesStrategicMerge:
  - mariadb-resources-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: pyload-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: qbittorrent-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: prowlarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: prowlarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod"
    target:
      kind: InfisicalSecret
      name: frigate-secrets-sync
  - path: infisical-config-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-config-sync
  - path: shm-patch-named.yaml
    target:
      kind: Deployment
      name: frigate
  - path: node-affinity-patch.yaml
    target:
      kind: Deployment
      name: frigate
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: frigate-litestream-secret
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
patches:
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: amule-secrets
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: radarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: radarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: whisparr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: whisparr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: mylar-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: mylar-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patchesStrategicMerge:
  - infisical-shared-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: birdnet-go
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: lidarr-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: lidarr-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: sabnzbd-secrets-sync
  - path: litestream-secret-patch.yaml
    target:
      kind: InfisicalSecret
      name: sabnzbd-litestream-secret
patchesStrategicMerge:
  - deployment-patch.yaml
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media
resources:
  - ../../base
  - ingress.yaml
patches:
  - target:
      kind: InfisicalSecret
      name: sonarr-secrets-sync
    patch: |-
      - op: replace
        path: /spec/authentication/universalAuth/secretsScope/envSlug
        value: prod
  - target:
      kind: InfisicalSecret
      name: sonarr-litestream-secret
    path: litestream-secret-patch.yaml
patchesStrategicMerge:
  - deployment-patch.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - prometheus-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: patch-alertmanager-command.yaml
    target:
      kind: StatefulSet
      name: prometheus-alertmanager
  - path: patch-infisical-env.yaml
    target:
      kind: InfisicalSecret
      name: alertmanager-secrets-sync
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - patch: "- op: replace\n  path: /spec/authentication/universalAuth/secretsScope/envSlug\n  value: prod\n"
    target:
      kind: InfisicalSecret
      name: promtail-secrets-sync
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: monitoring
resources:
  - ../../base
  - ingress.yaml
patches:
  - path: patch-alertmanager-config.yaml
    target:
      kind: StatefulSet
      name: alertmanager
  - path: patch-infisical-env.yaml
commonLabels:
  environment: prod
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
patches:
  - path: infisical-patch.yaml
    target:
      kind: InfisicalSecret
      name: loki-secrets-sync
resources:
  - ../../base
  - ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
patches:
  - path: patch-infisical-env.yaml
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: monitoring
resources:
  - ingress.yaml
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
namespace: monitoring
resources:
  - ../../base
  - grafana-ingress.yaml
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - includeSelectors: false
    pairs:
      environment: prod
resources:
  - ../../base
---
apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  environment: prod
kind: Kustomization
namespace: kube-system
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: hubble-ui
resources:
  - ../../base
