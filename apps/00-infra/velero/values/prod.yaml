# Velero - Production Environment Values

# Disable built-in credentials - we use env vars from shared litestream secret
credentials:
  useSecret: false

# Backup storage location - MinIO on Synology NAS
configuration:
  # Map LITESTREAM_* to AWS_* via environment variables
  extraEnvVars:
    - name: AWS_ACCESS_KEY_ID
      valueFrom:
        secretKeyRef:
          name: velero-s3-credentials
          key: LITESTREAM_ACCESS_KEY_ID
    - name: AWS_SECRET_ACCESS_KEY
      valueFrom:
        secretKeyRef:
          name: velero-s3-credentials
          key: LITESTREAM_SECRET_ACCESS_KEY

  backupStorageLocation:
    - name: default
      provider: aws
      bucket: backups-vixens-prod
      prefix: velero
      default: true
      accessMode: ReadWrite
      config:
        region: us-east-1  # MinIO default
        s3ForcePathStyle: "true"
        s3Url: http://192.168.111.69:9000

  # Volume snapshot location (optional, for CSI snapshots)
  volumeSnapshotLocation: []

  # Default backup TTL
  defaultBackupTTL: 720h  # 30 days

  # Garbage collection frequency
  garbageCollectionFrequency: 1h

  # Default repo maintenance frequency
  defaultRepoMaintainFrequency: 1h

# Backup schedules
schedules:
  # Daily backup of critical namespaces
  daily-critical:
    disabled: false
    schedule: "0 2 * * *"  # 2 AM daily
    template:
      ttl: "720h"  # 30 days retention
      storageLocation: default
      includedNamespaces:
        - databases
        - tools
        - security
      snapshotVolumes: true
      snapshotMoveData: false

  # Weekly full cluster backup
  weekly-full:
    disabled: false
    schedule: "0 3 * * 0"  # 3 AM Sunday
    template:
      ttl: "2160h"  # 90 days retention
      storageLocation: default
      includedNamespaces:
        - "*"
      excludedNamespaces:
        - kube-system
        - kube-public
        - kube-node-lease
      snapshotVolumes: true

  # Daily backup of home automation
  daily-home:
    disabled: false
    schedule: "0 4 * * *"  # 4 AM daily
    template:
      ttl: "168h"  # 7 days retention
      storageLocation: default
      includedNamespaces:
        - home
      snapshotVolumes: true
