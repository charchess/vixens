# Velero - Final SOTA 2026 Configuration
image:
  repository: velero/velero
  tag: v1.17.2
  pullPolicy: IfNotPresent

configuration:
  uploaderType: kopia
  repoMaintenanceJobConfigMap: velero-repo-maintenance-config
  defaultRepoMaintainFrequency: 24h
  
  # STORAGE LOCATION
  backupStorageLocation:
    - name: default
      provider: aws
      bucket: backups-vixens-prod
      prefix: velero
      default: true
      accessMode: ReadWrite
      config:
        region: us-east-1
        s3ForcePathStyle: "true"
        s3Url: http://192.168.111.69:9000

  volumeSnapshotLocation:
    - name: default
      provider: aws
      config:
        region: us-east-1

# BACKUP SCHEDULES
schedules:
  daily-critical:
    disabled: false
    schedule: "0 2 * * *"
    template:
      ttl: "720h"
      includedNamespaces: ["databases", "tools", "security"]
      snapshotVolumes: true
  daily-home:
    disabled: false
    schedule: "0 4 * * *"
    template:
      ttl: "168h"
      includedNamespaces: ["home"]
      snapshotVolumes: true
  weekly-full:
    disabled: false
    schedule: "0 3 * * 0"
    template:
      ttl: "2160h"
      includedNamespaces: ["*"]
      excludedNamespaces: ["kube-system", "kube-public", "kube-node-lease"]
      snapshotVolumes: true

# CLEANUP SETTINGS
maintenanceCronJob:
  enabled: false
upgradeCRDs: true
cleanUpCRDs: false

kubectl:
  image:
    repository: bitnami/kubectl
    tag: latest
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 100m
      memory: 256Mi

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

nodeAgent:
  enabled: true
  uploaderType: kopia
  resources:
    requests:
      cpu: 100m
      memory: 256Mi

initContainers:
  - name: velero-plugin-for-aws
    image: velero/velero-plugin-for-aws:v1.13.2
    imagePullPolicy: IfNotPresent
    volumeMounts:
      - mountPath: /target
        name: plugins
