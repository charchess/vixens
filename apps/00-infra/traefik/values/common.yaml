---
# Common Traefik Helm values for all environments
# Based on /root/terravixens/terraform/modules/shared/locals.tf and current deployment
# Source: argocd/overlays/dev/apps/traefik.yaml

# ============================================================================
# Providers Configuration
# ============================================================================
providers:
  kubernetesCRD:
    enabled: true
    allowCrossNamespace: true
  kubernetesIngress:
    enabled: true
    publishedService:
      enabled: true
# ============================================================================
# API and Dashboard
# ============================================================================
api:
  dashboard: true
  insecure: true # Dashboard accessible on internal network
# Dashboard IngressRoute disabled - managed by traefik-dashboard app
ingressRoute:
  dashboard:
    enabled: false
# ============================================================================
# Priority and Tolerations
# ============================================================================
priorityClassName: vixens-high
# From /root/terravixens/terraform/modules/shared/locals.tf
tolerations:
  - key: node-role.kubernetes.io/control-plane
    operator: Exists
    effect: NoSchedule
# ============================================================================
# Entrypoints / Ports Configuration
# ============================================================================
ports:
  web:
    port: 80
    exposedPort: 80
    expose: true
    redirectTo:
      port: websecure
  websecure:
    port: 443
    exposedPort: 443
    expose: true
    tls:
      enabled: true
  mqtt: # New entrypoint for Mosquitto
    port: 1883
    exposedPort: 1883
    expose: true
    protocol: TCP
  coiot: # New entrypoint for Home Assistant CoIoT (Shelly devices)
    port: 5683
    exposedPort: 5683
    expose: true
    protocol: UDP
  dns-tcp: # AdGuard Home TCP
    port: 53
    exposedPort: 53
    expose: true
    protocol: TCP
  dns-udp: # AdGuard Home UDP
    port: 53
    exposedPort: 53
    expose: true
    protocol: UDP
  slimproto-tcp: # MusicAssistant SlimProto TCP
    port: 3483
    exposedPort: 3483
    expose: true
    protocol: TCP
  slimproto-udp: # MusicAssistant SlimProto UDP
    port: 3483
    exposedPort: 3483
    expose: true
    protocol: UDP
  frigate-api: # Frigate HTTP API (Home Assistant integration)
    port: 5000
    exposedPort: 5000
    expose: true
    protocol: TCP
  frigate-rtsp: # Frigate RTSP streaming
    port: 8554
    exposedPort: 8554
    expose: true
    protocol: TCP
  frigate-webrtc: # Frigate WebRTC streaming
    port: 8555
    exposedPort: 8555
    expose: true
    protocol: TCP
  traefik:
    port: 9000
    expose: false
    exposedPort: 9000
