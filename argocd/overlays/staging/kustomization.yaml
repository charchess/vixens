---
# Staging environment ArgoCD applications
# All apps organized in apps/ subdirectory following new pattern
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: argocd

resources:
  # Infisical Operator for secrets management (wave -3)
  - apps/media-namespace.yaml
  - apps/infisical-operator.yaml
  # Cilium L2 Announcements + LB IPAM (wave -2)
  - apps/cilium-lb.yaml
  - apps/synology-csi-secrets.yaml       # Infisical secrets for Synology CSI (wave -1)
  - apps/traefik.yaml                    # Traefik Ingress Controller
  - apps/traefik-middlewares.yaml
  - apps/traefik-dashboard.yaml          # Traefik Dashboard hostname redirect
  - apps/argocd.yaml                     # ArgoCD Ingress for UI
  - apps/whoami.yaml                     # Test application
  - apps/cert-manager.yaml               # cert-manager (wave 0)
  - apps/cert-manager-secrets.yaml       # Infisical secrets for cert-manager (wave 0)
  - apps/cert-manager-webhook-gandi.yaml # Gandi DNS webhook (wave 1)
  - apps/cert-manager-config.yaml        # ClusterIssuers + Secret (wave 2)
  - apps/synology-csi.yaml
  - apps/nfs-storage.yaml
  - apps/mail-gateway.yaml
  - apps/homeassistant.yaml
  - apps/mosquitto.yaml                  # Mosquitto MQTT broker
  - apps/birdnet-go.yaml                 # BirdNET-Go bird song detection
  - apps/prometheus.yaml                 # Prometheus standalone monitoring
  - apps/prometheus-ingress.yaml         # Prometheus IngressRoutes with HTTP→HTTPS redirect
  - apps/grafana.yaml                    # Grafana standalone monitoring
  - apps/grafana-ingress.yaml            # Grafana IngressRoutes with HTTP→HTTPS redirect
  - apps/sabnzbd.yaml
  - apps/radarr.yaml
  - apps/sonarr.yaml
  - apps/lidarr.yaml
  - apps/booklore.yaml
  - apps/frigate.yaml
  - apps/jellyseerr.yaml
  - apps/jellyfin.yaml
  - apps/changedetection.yaml
  - apps/adguard-home.yaml
  - apps/netvisor.yaml
  - apps/alertmanager.yaml
  - apps/headlamp.yaml
  - apps/hubble-ui.yaml
